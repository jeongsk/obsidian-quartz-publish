# Feature Specification: 원격 저장소 파일 관리

**Feature Branch**: `009-remote-file-management`
**Created**: 2026-01-15
**Status**: Draft
**Input**: Linear Issue JEO-5 - 원격 저장소에서 중복/불필요한 파일 삭제 기능
**Linear Issue**: [JEO-5](https://linear.app/jeongsk/issue/JEO-5/원격-저장소에서-중복불필요한-파일-삭제-기능)

## Clarifications

### Session 2026-01-15

- Q: 파일 관리 UI 진입점은 어디인가? → A: 설정 탭에 "발행된 파일 관리" 버튼 추가
- Q: 일괄 삭제 시 최대 파일 수는? → A: 최대 50개 (API 제한 고려, 안전장치)
- Q: 중복 파일 판단 기준은? → A: 파일명만 비교 (경로 무관, 빠름)
- Q: 파일 목록 캐싱 전략은? → A: 세션 단위 캐싱 (모달 열 때 갱신, 수동 새로고침 버튼)
- Q: 파일 목록 기본 정렬 순서는? → A: 경로별 알파벳순 (폴더 구조 반영)

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 발행된 파일 목록 조회 (Priority: P1)

사용자는 Obsidian 플러그인 내에서 원격 저장소(GitHub)에 발행된 모든 파일 목록을 확인할 수 있습니다. 이를 통해 현재 어떤 노트가 공개되어 있는지 한눈에 파악할 수 있습니다.

**Why this priority**: 파일 삭제나 중복 감지 기능의 기반이 되는 핵심 기능입니다. 파일 목록을 조회할 수 없으면 다른 기능을 사용할 수 없습니다.

**Independent Test**: 플러그인에서 "발행된 파일 목록" 기능을 실행하고 GitHub 저장소의 실제 파일 목록과 일치하는지 확인하여 테스트할 수 있습니다.

**Acceptance Scenarios**:

1. **Given** 사용자가 GitHub 저장소가 설정된 상태에서, **When** 설정 탭의 "발행된 파일 관리" 버튼을 클릭하면, **Then** content 폴더 내의 모든 마크다운 파일 목록이 경로와 함께 모달에 표시됩니다.
2. **Given** 발행된 파일 목록이 표시된 상태에서, **When** 특정 파일을 선택하면, **Then** 해당 파일의 상세 정보(경로, 크기, 마지막 수정일)가 표시됩니다.
3. **Given** 원격 저장소에 파일이 없는 경우, **When** 발행된 파일 목록 보기를 요청하면, **Then** "발행된 파일이 없습니다" 메시지가 표시됩니다.

---

### User Story 2 - 원격 파일 삭제 (Priority: P1)

사용자는 발행된 파일 목록에서 선택한 파일을 원격 저장소에서 삭제할 수 있습니다. 이를 통해 GitHub에 직접 접근하지 않고도 불필요한 파일을 정리할 수 있습니다.

**Why this priority**: 이 기능의 핵심 목적입니다. 중복 파일이나 더 이상 공개하지 않을 노트를 플러그인 내에서 직접 삭제할 수 있어야 합니다.

**Independent Test**: 발행된 파일 목록에서 파일을 선택하고 삭제를 실행한 후, GitHub 저장소에서 해당 파일이 실제로 삭제되었는지 확인하여 테스트할 수 있습니다.

**Acceptance Scenarios**:

1. **Given** 발행된 파일 목록이 표시된 상태에서, **When** 사용자가 파일을 선택하고 삭제 버튼을 클릭하면, **Then** 삭제 확인 다이얼로그가 표시됩니다.
2. **Given** 삭제 확인 다이얼로그가 표시된 상태에서, **When** 사용자가 확인을 클릭하면, **Then** 파일이 원격 저장소에서 삭제되고 성공 알림이 표시됩니다.
3. **Given** 삭제 확인 다이얼로그가 표시된 상태에서, **When** 사용자가 취소를 클릭하면, **Then** 삭제가 취소되고 파일 목록 화면으로 돌아갑니다.
4. **Given** 여러 파일이 선택된 상태에서, **When** 삭제를 실행하면, **Then** 선택된 모든 파일이 일괄 삭제됩니다.

---

### User Story 3 - 중복 파일 감지 (Priority: P2)

시스템은 동일한 파일명이 여러 경로에 존재하는 경우 이를 자동으로 감지하여 사용자에게 알려줍니다. 이를 통해 경로 변경으로 인한 중복 파일을 쉽게 식별하고 정리할 수 있습니다.

**Why this priority**: 중복 파일 정리를 위한 편의 기능입니다. 핵심 기능(목록 조회, 삭제)이 없어도 수동으로 중복을 찾을 수 있지만, 이 기능이 있으면 작업 효율이 크게 향상됩니다.

**Independent Test**: 동일한 파일명을 가진 파일을 여러 경로에 발행한 후, 중복 파일 감지 기능을 실행하고 중복이 올바르게 표시되는지 확인하여 테스트할 수 있습니다.

**Acceptance Scenarios**:

1. **Given** 동일한 파일명이 서로 다른 경로에 존재하는 경우, **When** 발행된 파일 목록을 조회하면, **Then** 중복 파일이 시각적으로 구분되어 표시됩니다.
2. **Given** 중복 파일이 표시된 상태에서, **When** 중복 그룹을 선택하면, **Then** 해당 파일들의 경로가 나란히 비교 표시됩니다.
3. **Given** 중복 파일이 없는 경우, **When** 발행된 파일 목록을 조회하면, **Then** 중복 관련 알림 없이 일반 목록이 표시됩니다.

---

### Edge Cases

- 네트워크 연결이 끊어진 상태에서 파일 목록 조회/삭제를 시도하면 어떻게 되는가? → 적절한 오류 메시지 표시
- 삭제 중 네트워크 오류가 발생하면 어떻게 되는가? → 작업 실패 알림 및 재시도 안내
- 여러 파일을 일괄 삭제 중 일부만 실패하면 어떻게 되는가? → 성공/실패 결과 요약 표시
- GitHub API 속도 제한에 도달하면 어떻게 되는가? → 속도 제한 알림 및 대기 안내
- 매우 많은 파일(1000개 이상)이 있는 경우 목록 조회가 어떻게 되는가? → 페이지네이션 또는 지연 로딩 적용

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 시스템은 연결된 GitHub 저장소의 content 폴더 내 모든 마크다운 파일 목록을 조회할 수 있어야 합니다.
- **FR-002**: 시스템은 각 파일의 경로, 파일명, 마지막 수정일을 표시해야 합니다.
- **FR-003**: 사용자는 목록에서 하나 이상의 파일을 선택할 수 있어야 합니다.
- **FR-004**: 시스템은 선택된 파일을 원격 저장소에서 삭제할 수 있어야 합니다.
- **FR-005**: 시스템은 파일 삭제 전 확인 다이얼로그를 표시해야 합니다.
- **FR-006**: 시스템은 삭제 작업의 성공/실패 결과를 사용자에게 알려야 합니다.
- **FR-007**: 시스템은 동일한 파일명이 여러 경로에 존재하는 경우 이를 감지하고 시각적으로 표시해야 합니다 (파일명만 비교, 콘텐츠 비교 없음).
- **FR-008**: 시스템은 파일 목록을 파일명 또는 경로로 검색/필터링할 수 있어야 합니다.
- **FR-009**: 시스템은 네트워크 오류 시 적절한 오류 메시지를 표시해야 합니다.
- **FR-010**: 시스템은 여러 파일의 일괄 삭제를 지원해야 합니다 (최대 50개, API 속도 제한 및 안전장치).
- **FR-011**: 시스템은 파일 목록을 세션 단위로 캐싱하고, 수동 새로고침 버튼을 제공해야 합니다.
- **FR-012**: 시스템은 파일 목록을 경로별 알파벳순으로 기본 정렬해야 합니다.

### Key Entities

- **PublishedFile**: 원격 저장소에 발행된 파일을 나타냅니다. 주요 속성: 파일 경로, 파일명, SHA 해시, 마지막 수정일, 파일 크기
- **DuplicateGroup**: 동일한 파일명을 가진 파일들의 그룹을 나타냅니다. 주요 속성: 파일명, 경로 목록, 파일 개수

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자는 발행된 파일 목록을 5초 이내에 확인할 수 있습니다 (100개 파일 기준).
- **SC-002**: 사용자는 파일 삭제를 GitHub 웹사이트 방문 없이 플러그인 내에서 완료할 수 있습니다.
- **SC-003**: 중복 파일이 있는 경우 사용자가 3클릭 이내에 중복을 식별하고 삭제할 수 있습니다.
- **SC-004**: 파일 삭제 성공률이 99% 이상입니다 (네트워크 정상 상태 기준).
- **SC-005**: 사용자는 파일 목록에서 원하는 파일을 10초 이내에 검색/찾을 수 있습니다.

## Assumptions

- 사용자는 이미 GitHub 저장소를 플러그인에 연결해 둔 상태입니다.
- GitHub API 토큰에 파일 삭제 권한(repo scope)이 포함되어 있습니다.
- 발행된 파일은 저장소의 `content/` 폴더 내에 위치합니다.
- 삭제 대상은 마크다운 파일(.md)로 제한됩니다.
- 로컬 Obsidian 볼트의 파일은 원격 삭제 시 영향받지 않습니다.
