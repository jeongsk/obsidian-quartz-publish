# Feature Specification: 발행 대시보드 콘텐츠 해시 불일치 버그 수정 및 UX 개선

**Feature Branch**: `001-fix-content-hash`
**Created**: 2026-01-15
**Status**: Draft
**Input**: User description: "Fix publish dashboard showing all files as modified due to content hash mismatch"

## 문제 요약

1. **버그**: 발행 대시보드에서 이미 발행된 모든 파일이 "수정됨" 상태로 표시됩니다. 원인은 발행 시 **변환된 콘텐츠**의 해시를 저장하지만, 상태 확인 시 **원본 콘텐츠**의 해시와 비교하기 때문입니다.

2. **UX 개선**: 각 탭(신규, 수정됨, 삭제 필요, 최신)의 의미를 사용자가 쉽게 이해할 수 있도록 탭 아래에 간단한 설명을 추가합니다.

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 발행된 파일 상태 정확히 표시 (Priority: P1)

사용자가 발행 대시보드를 열었을 때, 실제로 수정되지 않은 발행된 파일들은 "최신" 탭에 표시되어야 합니다. 파일 내용이 변경된 경우에만 "수정됨" 탭에 표시되어야 합니다.

**Why this priority**: 발행 대시보드의 핵심 기능입니다. 파일 상태가 정확하지 않으면 사용자가 어떤 파일을 발행해야 하는지 판단할 수 없습니다.

**Independent Test**: 파일을 발행한 후 대시보드를 다시 열어서 해당 파일이 "최신" 탭에 표시되는지 확인할 수 있습니다.

**Acceptance Scenarios**:

1. **Given** 파일이 성공적으로 발행된 상태, **When** 발행 대시보드를 열면, **Then** 해당 파일은 "최신" 탭에 표시됩니다.
2. **Given** 발행된 파일의 내용을 수정한 상태, **When** 발행 대시보드를 열면, **Then** 해당 파일은 "수정됨" 탭에 표시됩니다.
3. **Given** 파일이 발행되지 않은 상태(발행 기록 없음), **When** 발행 대시보드를 열면, **Then** 해당 파일은 "신규" 탭에 표시됩니다.

---

### User Story 2 - 프론트매터 자동 수정 후 상태 유지 (Priority: P2)

발행 과정에서 프론트매터에 자동으로 추가되는 필드(publish 플래그, 날짜 필드)가 있어도, 발행 직후 파일이 "최신" 상태로 표시되어야 합니다.

**Why this priority**: 발행 과정에서 파일이 자동 수정될 수 있으며, 이 경우에도 상태가 정확해야 합니다.

**Independent Test**: 프론트매터에 날짜 필드가 없는 파일을 발행한 후, 대시보드에서 "최신" 상태로 표시되는지 확인할 수 있습니다.

**Acceptance Scenarios**:

1. **Given** 프론트매터에 날짜 필드가 없는 파일, **When** 파일을 발행하면, **Then** 발행 후 대시보드에서 "최신"으로 표시됩니다.
2. **Given** 프론트매터에 publish: true가 없는 파일, **When** 파일을 발행하면, **Then** publish 플래그가 자동 추가되고 "최신"으로 표시됩니다.

---

### User Story 3 - 탭 상태 설명 표시 (Priority: P3)

사용자가 발행 대시보드를 열었을 때, 각 탭이 의미하는 상태를 쉽게 이해할 수 있도록 탭 영역 아래에 현재 선택된 탭에 대한 간단한 설명이 표시됩니다.

**Why this priority**: 사용자 경험 개선 기능으로, 핵심 버그 수정보다 우선순위가 낮지만 사용성을 높입니다.

**Independent Test**: 대시보드를 열고 각 탭을 클릭하여 해당 탭의 설명이 표시되는지 확인할 수 있습니다.

**Acceptance Scenarios**:

1. **Given** 발행 대시보드가 열린 상태, **When** "신규" 탭을 선택하면, **Then** "아직 발행되지 않은 새 노트입니다" 설명이 표시됩니다.
2. **Given** 발행 대시보드가 열린 상태, **When** "수정됨" 탭을 선택하면, **Then** "발행 후 내용이 변경된 노트입니다" 설명이 표시됩니다.
3. **Given** 발행 대시보드가 열린 상태, **When** "삭제 필요" 탭을 선택하면, **Then** "로컬에서 삭제되었거나 발행 해제된 노트입니다" 설명이 표시됩니다.
4. **Given** 발행 대시보드가 열린 상태, **When** "최신" 탭을 선택하면, **Then** "원격과 동기화된 최신 상태의 노트입니다" 설명이 표시됩니다.

---

### Edge Cases

- 발행 중 네트워크 오류로 실패한 경우: 발행 기록이 저장되지 않으므로 "신규" 상태 유지
- 이미 저장된 잘못된 해시가 있는 기존 발행 기록: "모두 동기화"를 통해 새로운 해시로 업데이트 필요
- 동일한 내용이지만 공백/줄바꿈만 다른 경우: 해시가 다르므로 "수정됨"으로 표시 (의도된 동작)

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 시스템은 발행 시 **원본 파일 콘텐츠**(변환 전, 프론트매터 자동 수정 후)의 해시를 저장해야 합니다.
- **FR-002**: 시스템은 상태 확인 시 현재 파일 콘텐츠의 해시를 저장된 해시와 비교하여 수정 여부를 판단해야 합니다.
- **FR-003**: 해시가 일치하면 "최신(synced)" 상태로, 불일치하면 "수정됨(modified)" 상태로 분류해야 합니다.
- **FR-004**: 발행 과정에서 프론트매터가 자동 수정된 경우, 수정된 콘텐츠의 해시를 저장해야 합니다.
- **FR-005**: 발행 대시보드는 현재 선택된 탭의 상태 설명을 탭 영역 아래에 표시해야 합니다.

### Key Entities

- **PublishRecord**: 발행 기록을 나타내며, contentHash 필드에 원본 파일의 해시를 저장합니다.
- **NoteStatus**: 파일의 현재 상태(new, modified, synced, deleted)를 나타냅니다.

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 파일 발행 후 대시보드를 열면 해당 파일이 "최신" 탭에 표시됩니다 (100% 정확도).
- **SC-002**: 발행된 파일의 내용을 수정하면 "수정됨" 탭에 정확히 표시됩니다.
- **SC-003**: 발행되지 않은 파일은 "신규" 탭에 표시됩니다.
- **SC-004**: 프론트매터 자동 수정이 발생해도 발행 직후 "최신" 상태로 표시됩니다.
- **SC-005**: 각 탭을 선택하면 해당 탭의 상태 설명이 즉시 표시됩니다.

## Assumptions

- 기존에 잘못된 해시로 저장된 발행 기록은 "모두 동기화" 기능을 통해 한 번 재발행하면 올바른 해시로 업데이트됩니다.
- 콘텐츠 변환(링크 변환, 첨부파일 경로 변경 등)은 GitHub에 업로드되는 콘텐츠에만 적용되며, 로컬 파일에는 영향을 주지 않습니다.
- 해시 비교는 SHA-256 알고리즘을 사용합니다.

## Clarifications

### Session 2026-01-15

- Q: 탭 상태 설명 기능을 현재 버그 수정에 포함할지, 별도 기능으로 분리할지? → A: 현재 버그 수정에 포함 (동일한 대시보드 모달 수정으로 효율적)
